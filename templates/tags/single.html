{% extends "base.html" %}

{% import "partials/helpers-preview.html" as helpers_preview %}

{% block posthead %}
  {% for post in term.pages %}
    <link rel="prerender" href="{{ post.permalink }}" />
  {% endfor %}
{% endblock posthead %}

{% block content %}
<div class="tag-single">
  <a href="{% if lang == 'es' %}/es/topics/{% else %}/topics/{% endif %}" class="tag-single__back">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M19 12H5M12 19l-7-7 7-7"/>
    </svg>
    {{ trans(key="nav_topics", lang=lang) }}
  </a>

  <header class="tag-single__header">
    <span class="tag-single__label">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
        <line x1="7" y1="7" x2="7.01" y2="7"></line>
      </svg>
      {{ term.name }}
    </span>
    <h1>{{ term.pages | length }} {% if term.pages | length == 1 %}{{ trans(key="post", lang=lang) }}{% else %}{{ trans(key="posts", lang=lang) }}{% endif %}</h1>
    {% for td in config.extra.tag_descriptions %}
      {% if td.name == term.name %}
        <p class="tag-single__description">
          {% if lang == "es" %}{{ td.desc_es }}{% else %}{{ td.desc }}{% endif %}
        </p>
      {% endif %}
    {% endfor %}
  </header>

  <div class="tag-single__posts">
    {% for post in term.pages %}
    <a href="{{ post.permalink }}" class="tag-single__post">
      {% if post.extra.static_thumbnail %}
      <div class="tag-single__post-thumb">
        <img src="{{ post.extra.static_thumbnail }}" alt="{{ post.title }}" />
      </div>
      {% elif post.extra.thumbnail %}
      <div class="tag-single__post-thumb">
        <img src="{{ get_url(path=post.path ~ post.extra.thumbnail) }}" alt="{{ post.title }}" />
      </div>
      {% endif %}
      <div class="tag-single__post-content">
        <div class="tag-single__post-meta">
          {% if post.path is containing("blog/") %}
          <span class="tag-single__post-type tag-single__post-type--blog">{{ trans(key="nav_blog", lang=lang) }}</span>
          {% elif post.path is containing("readings/") %}
          <span class="tag-single__post-type tag-single__post-type--reading">{{ trans(key="nav_readings", lang=lang) }}</span>
          {% elif post.path is containing("talks/") %}
          <span class="tag-single__post-type tag-single__post-type--talk">{{ trans(key="nav_talks", lang=lang) }}</span>
          {% endif %}
          {% if post.date %}
          <span class="tag-single__post-date">{% if lang == "es" %}{{ post.date | date(format="%d/%m/%Y") }}{% else %}{{ post.date | date(format="%B %d, %Y") }}{% endif %}</span>
          {% endif %}
        </div>
        <h3>{{ post.title }}</h3>
        {% if post.description %}
        <p class="tag-single__post-desc">{{ post.description | truncate(length=220) }}</p>
        {% endif %}
        {% if post.taxonomies.tags %}
        <div class="tag-single__post-tags">
          {% for tag in post.taxonomies.tags %}
          <span class="tag-single__post-tag{% if tag == term.name %} tag-single__post-tag--active{% endif %}">{{ tag }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </a>
    {% endfor %}
  </div>
</div>
{% endblock content %}
