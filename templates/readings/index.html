{% extends "blog/index.html" %}

{% import "helpers-preview.html" as helpers_preview %}

{% block title %}
  Readings | Chemaclass
{% endblock %}

{% block content %}
  {{ section.content | safe }}

  {% set pinned_posts = section.pages | filter(attribute="extra.pin", value=true) %}

  <div class="readings-previews">
    {% if pinned_posts %}
    <div class="readings-previews-highlighted">
      <h4>Highlighted</h4>
      {% for post in pinned_posts %}
        {{ self::reading_preview(post=post)}}
      {% endfor %}
    </div>
    {% endif %}

    {% for post in section.pages %}
      {%if post not in pinned_posts %}
        {{ self::reading_preview(post=post)}}
      {% endif %}
    {% endfor %}
  </div>

  <footer>
    {{ helpers_preview::footer() }}
  </footer>
{% endblock %}


{% macro reading_preview(post) %}
  <div class="reading-preview">
    <h3 class="reading-title{% if post.extra.with_long_title %} reading-title_long{% endif %}">
      <a href="{{ post.permalink }}">{{ post.title }}</a>
      <br>
      {{ helpers_preview::author(post=post) }}
    </h3>
    <span class="reading-date">
      {{ post.date | date(format="%B %d, %Y") }}
    </span>
    <div class="summary">
      {% if post.extra.with_long_title %}
        {{ helpers_preview::summary(post=post,read_more=true) }}
      {% else %}
        {{ helpers_preview::summary(post=post,read_more=false) }}
      {% endif %}
    </div>

    {% if post.extra.current_read %}
    <span class="reading-current no-select">Current read</span>
    {% endif %}
  </div>
{% endmacro %}