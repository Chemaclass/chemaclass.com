{% extends "base.html" %}

{% block posthead %}
  {% if page.lower %}
  <link rel="prerender" href="{{ page.lower.permalink }}">
  {% endif %}

  {% if page.higher %}
  <link rel="prerender" href="{{ page.higher.permalink }}">
  {% endif %}

  {% for tag in page.taxonomies.tags %}
  <link rel="prerender" href='{{ get_taxonomy_url(kind="tags", name=tag) }}'>
  {% endfor %}

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://google.com/article"
      },
      "headline": "{{ page.title }}",
      "image": [{% if page.extra.static_thumbnail %} "{{ config.base_url|safe }}{{ page.extra.static_thumbnail|safe }}"{% endif %}]{% if page.date %},
      "datePublished": "{{ page.date | date(format="%+") }}"{% endif %}{% if page.date %},
      "dateModified": "{{ page.date | date(format="%+") }}"{% endif %}{% if config.extra.author %},
      "author": {
        "@type": "Person",
        "name": "{{ config.extra.author }}"
      },
      "publisher": {
        "@type": "Organization",
        "name": "{{ config.extra.author }}"{% if config.extra.icon %},
        "logo": {
          "@type": "ImageObject",
          "url": "{{ get_url(path=config.extra.icon) | safe }}"
        }
        {% endif %}
      }
      {% endif %}
    }
  </script>

  {% set len_ancestors = page.ancestors | length %}
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [ {% for section_path in page.ancestors %}
        { {% set section = get_section(path=section_path) %}
          "@type": "ListItem",
          "position": {{ loop.index }},
          "name": "{{ section.title }}",
          "item": "{{ section.permalink | safe }}"
        },{% endfor %}
        {
          "@type": "ListItem",
          "position": {{ len_ancestors + 1 }},
          "name": "{{ page.title }}",
          "item": "{{ page.permalink | safe }}"
        }
      ]
    }
  </script>
{% endblock posthead %}

{% block content %}
  <article class="talk-single">
    <!-- Back link -->
    <a href="/talks/" class="talk-single__back">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      All Talks
    </a>

    <!-- Hero section -->
    <header class="talk-single__hero">
      <h1 class="talk-single__title">{{ page.title }}</h1>
      {% if page.extra.subtitle %}
        <p class="talk-single__subtitle">{{ page.extra.subtitle }}</p>
      {% endif %}
      {% if page.taxonomies.tags %}
        <div class="talk-single__tags">
          {% for tag in page.taxonomies.tags %}
            <a href="{{ get_taxonomy_url(kind='tags', name=tag) }}" class="talk-single__tag">{{ tag }}</a>
          {% endfor %}
        </div>
      {% endif %}
    </header>

    <!-- Content (appearances list + images) -->
    <section class="talk-single__content">
      {{ page.content | safe }}
    </section>

    <!-- Navigation between talks -->
    <nav class="talk-single__nav">
      {% if page.lower %}
        <a href="{{ page.lower.permalink }}" class="talk-single__nav-link talk-single__nav-link--prev">
          <span class="talk-single__nav-label">Previous</span>
          <span class="talk-single__nav-title">{{ page.lower.title }}</span>
        </a>
      {% else %}
        <span></span>
      {% endif %}
      {% if page.higher %}
        <a href="{{ page.higher.permalink }}" class="talk-single__nav-link talk-single__nav-link--next">
          <span class="talk-single__nav-label">Next</span>
          <span class="talk-single__nav-title">{{ page.higher.title }}</span>
        </a>
      {% endif %}
    </nav>
  </article>

  {% include "footer-about.html" %}
{% endblock content %}
